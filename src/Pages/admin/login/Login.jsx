import { CloseIcon, MessageIcon } from "../../../UI/Icons";
import "./login.css";
import { useFormik } from "formik"
import Api, { handleApiError } from "../../../config/api"
import { useDispatch } from "react-redux"
import { getUserData } from "../../../redux/slices/user.slice";
import { useNavigate } from "react-router-dom"
import { notifySuccess } from "../../../config/toastify";

function Login() {
  const dispatch = useDispatch()
  const navigate = useNavigate()

  const icons = {
    user: (
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g clip-path="url(#clip0_101_30470)">
          <path
            d="M12 12C13.1867 12 14.3467 11.6481 15.3334 10.9888C16.3201 10.3295 17.0892 9.39246 17.5433 8.2961C17.9974 7.19975 18.1162 5.99335 17.8847 4.82946C17.6532 3.66558 17.0818 2.59648 16.2426 1.75736C15.4035 0.918247 14.3344 0.346802 13.1705 0.115291C12.0067 -0.11622 10.8003 0.00259972 9.7039 0.456726C8.60754 0.910851 7.67047 1.67989 7.01118 2.66658C6.35189 3.65328 6 4.81331 6 6C6.00159 7.59081 6.63424 9.11602 7.75911 10.2409C8.88399 11.3658 10.4092 11.9984 12 12ZM12 2C12.7911 2 13.5645 2.2346 14.2223 2.67412C14.8801 3.11365 15.3928 3.73836 15.6955 4.46927C15.9983 5.20017 16.0775 6.00444 15.9231 6.78036C15.7688 7.55629 15.3878 8.26902 14.8284 8.82843C14.269 9.38784 13.5563 9.7688 12.7804 9.92314C12.0044 10.0775 11.2002 9.99827 10.4693 9.69552C9.73836 9.39277 9.11365 8.88008 8.67412 8.22228C8.2346 7.56449 8 6.79113 8 6C8 4.93914 8.42143 3.92172 9.17157 3.17158C9.92172 2.42143 10.9391 2 12 2Z"
            fill="white"
          />
          <path
            d="M12 14C9.61386 14.0026 7.32622 14.9517 5.63896 16.639C3.95171 18.3262 3.00265 20.6139 3 23C3 23.2652 3.10536 23.5196 3.29289 23.7071C3.48043 23.8946 3.73478 24 4 24C4.26522 24 4.51957 23.8946 4.70711 23.7071C4.89464 23.5196 5 23.2652 5 23C5 21.1435 5.7375 19.363 7.05025 18.0503C8.36301 16.7375 10.1435 16 12 16C13.8565 16 15.637 16.7375 16.9497 18.0503C18.2625 19.363 19 21.1435 19 23C19 23.2652 19.1054 23.5196 19.2929 23.7071C19.4804 23.8946 19.7348 24 20 24C20.2652 24 20.5196 23.8946 20.7071 23.7071C20.8946 23.5196 21 23.2652 21 23C20.9974 20.6139 20.0483 18.3262 18.361 16.639C16.6738 14.9517 14.3861 14.0026 12 14Z"
            fill="white"
          />
        </g>
        <defs>
          <clipPath id="clip0_101_30470">
            <rect width="24" height="24" fill="white" />
          </clipPath>
        </defs>
      </svg>
    ),
    password: (
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g opacity="0.5" clip-path="url(#clip0_101_30484)">
          <path
            d="M18.9999 8.424V7C18.9999 5.14348 18.2624 3.36301 16.9497 2.05025C15.6369 0.737498 13.8565 0 11.9999 0C10.1434 0 8.36295 0.737498 7.05019 2.05025C5.73744 3.36301 4.99994 5.14348 4.99994 7V8.424C4.1093 8.81271 3.35123 9.45252 2.81844 10.2652C2.28564 11.0779 2.00122 12.0282 1.99994 13V19C2.00153 20.3256 2.52882 21.5964 3.46616 22.5338C4.4035 23.4711 5.67434 23.9984 6.99994 24H16.9999C18.3255 23.9984 19.5964 23.4711 20.5337 22.5338C21.4711 21.5964 21.9984 20.3256 21.9999 19V13C21.9987 12.0282 21.7142 11.0779 21.1814 10.2652C20.6486 9.45252 19.8906 8.81271 18.9999 8.424ZM6.99994 7C6.99994 5.67392 7.52672 4.40215 8.46441 3.46447C9.40209 2.52678 10.6739 2 11.9999 2C13.326 2 14.5978 2.52678 15.5355 3.46447C16.4732 4.40215 16.9999 5.67392 16.9999 7V8H6.99994V7ZM19.9999 19C19.9999 19.7956 19.6839 20.5587 19.1213 21.1213C18.5587 21.6839 17.7956 22 16.9999 22H6.99994C6.20429 22 5.44123 21.6839 4.87862 21.1213C4.31601 20.5587 3.99994 19.7956 3.99994 19V13C3.99994 12.2044 4.31601 11.4413 4.87862 10.8787C5.44123 10.3161 6.20429 10 6.99994 10H16.9999C17.7956 10 18.5587 10.3161 19.1213 10.8787C19.6839 11.4413 19.9999 12.2044 19.9999 13V19Z"
            fill="#331C48"
          />
          <path
            d="M11.9999 14C11.7347 14 11.4804 14.1054 11.2928 14.2929C11.1053 14.4804 10.9999 14.7348 10.9999 15V17C10.9999 17.2652 11.1053 17.5196 11.2928 17.7071C11.4804 17.8946 11.7347 18 11.9999 18C12.2652 18 12.5195 17.8946 12.7071 17.7071C12.8946 17.5196 13 17.2652 13 17V15C13 14.7348 12.8946 14.4804 12.7071 14.2929C12.5195 14.1054 12.2652 14 11.9999 14Z"
            fill="#331C48"
          />
        </g>
        <defs>
          <clipPath id="clip0_101_30484">
            <rect width="24" height="24" fill="white" />
          </clipPath>
        </defs>
      </svg>
    ),
    hand: (
      <svg
        width="23"
        height="32"
        viewBox="0 0 23 32"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M8.71072 18.4442V17.7411H8.21072H7.71072C7.71072 18.7042 6.9903 19.4249 6.17132 19.4249H6.16658C5.34873 19.4249 4.62797 18.7042 4.62797 17.7411V16.6335H4.12797H3.62797C3.62797 17.5963 2.90724 18.317 2.08935 18.317H2.04403C1.2272 18.317 0.507519 17.5993 0.505415 16.6385V16.6384C0.498547 13.7858 0.499832 12.7975 0.503164 10.233C0.504433 9.25705 0.505999 8.05289 0.507524 6.4309C0.510454 3.37049 2.81921 0.951361 5.59526 0.951361L12.216 0.951361C14.043 0.951361 15.7465 2.01157 16.6535 3.75314L22.37 14.736L22.064 14.9898L22.0542 14.9979L22.0449 15.0065C20.9828 15.9827 19.3926 15.8685 18.4607 14.7342C18.4607 14.7342 18.4607 14.7342 18.4607 14.7342L16.8087 12.723L15.9233 11.6451L15.9224 13.04L15.9129 26.8758V26.8758C15.9122 27.8382 15.1915 28.5586 14.374 28.5586H14.3735C13.5555 28.5586 12.8346 27.8373 12.8346 26.8743L12.8346 18.5008L11.8347 18.4894C11.8133 19.4304 11.1031 20.128 10.2973 20.128H10.2496C9.43148 20.128 8.71072 19.4071 8.71072 18.4442Z"
          fill="#F7CAA5"
          stroke="#331C48"
        />
        <path
          d="M14.3808 32C17.0413 31.9971 19.1972 29.841 19.2003 27.1804C19.2003 26.8824 18.9587 26.6407 18.6606 26.6407C18.3626 26.6407 18.1209 26.8824 18.1209 27.1804C18.1209 29.2462 16.4462 30.9206 14.3808 30.9206C12.3153 30.9206 10.6406 29.2462 10.6406 27.1804C10.6406 26.8824 10.3989 26.6407 10.1009 26.6407C9.80283 26.6407 9.56118 26.8824 9.56118 27.1804C9.56435 29.841 11.7202 31.9971 14.3808 32Z"
          fill="#331C48"
        />
      </svg>
    ),
    eye: (
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g opacity="0.5" clip-path="url(#clip0_101_30483)">
          <path
            d="M23.2709 9.4183C21.7199 6.8923 18.1919 2.6543 11.9999 2.6543C5.80787 2.6543 2.27987 6.8923 0.728868 9.4183C0.249396 10.1938 -0.00457764 11.0875 -0.00457764 11.9993C-0.00457764 12.9111 0.249396 13.8048 0.728868 14.5803C2.27987 17.1063 5.80787 21.3443 11.9999 21.3443C18.1919 21.3443 21.7199 17.1063 23.2709 14.5803C23.7503 13.8048 24.0043 12.9111 24.0043 11.9993C24.0043 11.0875 23.7503 10.1938 23.2709 9.4183ZM21.5659 13.5333C20.2339 15.6993 17.2189 19.3443 11.9999 19.3443C6.78087 19.3443 3.76587 15.6993 2.43387 13.5333C2.149 13.0723 1.99812 12.5412 1.99812 11.9993C1.99812 11.4574 2.149 10.9263 2.43387 10.4653C3.76587 8.2993 6.78087 4.6543 11.9999 4.6543C17.2189 4.6543 20.2339 8.2953 21.5659 10.4653C21.8507 10.9263 22.0016 11.4574 22.0016 11.9993C22.0016 12.5412 21.8507 13.0723 21.5659 13.5333Z"
            fill="#331C48"
          />
          <path
            d="M11.9998 7C11.0109 7 10.0442 7.29324 9.22194 7.84265C8.39969 8.39206 7.75883 9.17295 7.38039 10.0866C7.00195 11.0002 6.90294 12.0055 7.09586 12.9755C7.28879 13.9454 7.76499 14.8363 8.46425 15.5355C9.16352 16.2348 10.0544 16.711 11.0243 16.9039C11.9942 17.0969 12.9996 16.9978 13.9132 16.6194C14.8268 16.241 15.6077 15.6001 16.1571 14.7779C16.7065 13.9556 16.9998 12.9889 16.9998 12C16.9982 10.6744 16.4709 9.40356 15.5336 8.46622C14.5962 7.52888 13.3254 7.00159 11.9998 7ZM11.9998 15C11.4064 15 10.8264 14.8241 10.3331 14.4944C9.83973 14.1648 9.45521 13.6962 9.22815 13.1481C9.00109 12.5999 8.94168 11.9967 9.05743 11.4147C9.17319 10.8328 9.45891 10.2982 9.87847 9.87868C10.298 9.45912 10.8326 9.1734 11.4145 9.05764C11.9965 8.94189 12.5997 9.0013 13.1478 9.22836C13.696 9.45542 14.1646 9.83994 14.4942 10.3333C14.8238 10.8266 14.9998 11.4067 14.9998 12C14.9998 12.7957 14.6837 13.5587 14.1211 14.1213C13.5585 14.6839 12.7954 15 11.9998 15Z"
            fill="#331C48"
          />
        </g>
        <defs>
          <clipPath id="clip0_101_30483">
            <rect width="24" height="24" fill="white" />
          </clipPath>
        </defs>
      </svg>
    ),
    dark: (
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M12 24C18.6274 24 24 18.6274 24 12C24 5.37258 18.6274 0 12 0C5.37258 0 0 5.37258 0 12C0 18.6274 5.37258 24 12 24Z"
          fill="#27536B"
        />
        <path
          d="M18.3585 13.7347C17.7611 14.3319 17.0405 14.7917 16.2472 15.0819C15.4538 15.3721 14.6067 15.4858 13.7649 15.415C12.9231 15.3443 12.1069 15.0908 11.3731 14.6723C10.6393 14.2538 10.0056 13.6802 9.51622 12.9917C9.02681 12.3031 8.69344 11.5161 8.53937 10.6855C8.3853 9.85493 8.41422 9.00073 8.62412 8.18246C8.83402 7.36419 9.21984 6.60154 9.75471 5.94766C10.2896 5.29379 10.9606 4.76443 11.721 4.39648C10.2434 4.43602 8.80982 4.9078 7.59752 5.75348C6.38522 6.59915 5.44739 7.78163 4.90001 9.15467C4.35264 10.5277 4.21974 12.0311 4.51774 13.4788C4.81575 14.9266 5.53158 16.2553 6.57672 17.3005C7.62187 18.3458 8.95046 19.0617 10.3982 19.3599C11.8459 19.658 13.3493 19.5253 14.7224 18.978C16.0955 18.4308 17.2781 17.4931 18.1239 16.2809C18.9697 15.0686 19.4416 13.6351 19.4813 12.1575C19.1981 12.7424 18.8185 13.2756 18.3585 13.7347Z"
          fill="#FCD57E"
        />
        <path
          d="M16.6905 7.20289L16.9583 9.62539L17.226 7.20289L19.6485 6.93514L17.226 6.66739L16.9605 4.24414L16.6928 6.66664L14.2695 6.93439L16.6905 7.20289Z"
          fill="white"
        />
        <path
          d="M5.27023 19.2601L5.46223 20.9956L5.65423 19.2601L7.38973 19.0681L5.65423 18.8761L5.46223 17.1406L5.27023 18.8761L3.53473 19.0681L5.27023 19.2601Z"
          fill="white"
        />
        <path
          d="M11.6507 11.5411L11.307 11.8848L11.6507 12.2284L11.9943 11.8848L11.6507 11.5411Z"
          fill="white"
        />
        <path
          d="M19.8947 8.96885L19.551 9.3125L19.8947 9.65615L20.2383 9.3125L19.8947 8.96885Z"
          fill="white"
        />
        <path
          d="M21.3526 13.2403L21.009 13.584L21.3526 13.9276L21.6963 13.584L21.3526 13.2403Z"
          fill="white"
        />
        <path
          d="M3.81088 5.74033L3.46722 6.08398L3.81088 6.42764L4.15453 6.08398L3.81088 5.74033Z"
          fill="white"
        />
        <path
          d="M16.4882 19.6681L16.1445 20.0117L16.4882 20.3554L16.8318 20.0117L16.4882 19.6681Z"
          fill="white"
        />
        <path
          d="M5.75863 4.49033L5.41498 4.83398L5.75863 5.17764L6.10229 4.83398L5.75863 4.49033Z"
          fill="white"
        />
      </svg>
    ),
    language: (
      <svg
        width="25"
        height="25"
        viewBox="0 0 25 25"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M12.026 6.9908e-06C9.24618 -0.00299067 6.55137 0.958143 4.40088 2.71958C2.2504 4.48103 0.777333 6.93375 0.232778 9.65968C-0.311777 12.3856 0.105881 15.2161 1.41456 17.6685C2.72325 20.121 4.84195 22.0437 7.40955 23.109C9.97714 24.1742 12.8347 24.316 15.4952 23.5103C18.1556 22.7045 20.4543 21.001 21.9994 18.6902C23.5445 16.3793 24.2403 13.6042 23.9684 10.8377C23.6964 8.07126 22.4735 5.48473 20.508 3.51901C18.259 1.2678 15.208 0.00201249 12.026 6.9908e-06ZM20.673 7.00001H17.452C16.7294 5.32869 15.7783 3.76578 14.626 2.35601C17.1743 3.04776 19.3471 4.71644 20.673 7.00001ZM16.526 12C16.5178 13.0181 16.3574 14.0293 16.05 15H8.00197C7.69462 14.0293 7.53418 13.0181 7.52597 12C7.53418 10.9819 7.69462 9.97068 8.00197 9.00001H16.05C16.3574 9.97068 16.5178 10.9819 16.526 12ZM8.80397 17H15.248C14.3992 18.6757 13.3141 20.2208 12.026 21.588C10.7374 20.2212 9.65224 18.676 8.80397 17ZM8.80397 7.00001C9.65275 5.32429 10.7378 3.77917 12.026 2.41201C13.3146 3.77878 14.3997 5.32396 15.248 7.00001H8.80397ZM9.42597 2.35601C8.27363 3.76579 7.32256 5.3287 6.59997 7.00001H3.37897C4.70483 4.71644 6.87763 3.04776 9.42597 2.35601ZM2.48697 9.00001H5.92597C5.66672 9.97915 5.53232 10.9871 5.52597 12C5.53232 13.0129 5.66672 14.0209 5.92597 15H2.48697C1.87231 13.0472 1.87231 10.9528 2.48697 9.00001ZM3.37897 17H6.59997C7.32256 18.6713 8.27363 20.2342 9.42597 21.644C6.87763 20.9523 4.70483 19.2836 3.37897 17ZM14.626 21.644C15.7783 20.2342 16.7294 18.6713 17.452 17H20.673C19.3471 19.2836 17.1743 20.9523 14.626 21.644ZM21.565 15H18.126C18.3852 14.0209 18.5196 13.0129 18.526 12C18.5196 10.9871 18.3852 9.97916 18.126 9.00001H21.563C22.1777 10.9528 22.1777 13.0472 21.563 15H21.565Z"
          fill="black"
        />
      </svg>
    ),

  };

  function handleSubmit(values) {

    Api.post("/auth/login", values)
      .then(() => {
        notifySuccess("Welcome !!")
        dispatch(getUserData())
        navigate("/admin")
      })
      .catch((error) => {
        handleApiError(error)
      })

  }

  const formik = useFormik({
    initialValues: {
      email: "",
      password: "",
    },
    onSubmit: handleSubmit,
  });

  return (
    <div className="login_section flex center">
      <div className=" welcome_box center">
        <div className="container_box">
          <img src="../assets/loginBg.svg" />
        </div>
      </div>
      <div className=" center column space_between login_box">
        <nav className='login_nav'>
          <img src="../assets/logo.png" />
          <div>
            <div className="icon_box">
              {icons.dark}
              <span>مظلم</span>
            </div>
            <div className="icon_box">
              {icons.language}
              <span>English</span>
            </div>
          </div>
        </nav>
        {/* <AdminNavbar /> */}
        <div className="container_box flex column gap_2">
          <div className="m_auto">
            <img src="../assets/profileImg.svg" className="profile m_auto" />
            <h2 className="center gap_1">
              نورت مكانك يسطا
              {icons.hand}
            </h2>
          </div>
          <form className="flex column gap_3 w_100" onSubmit={formik.handleSubmit} >
            <div className="input_control w_100">
              <div className="label ">
                <p>الإيميل</p>
              </div>
              <div className="label_input">
                <MessageIcon />
                <input
                  value={formik.values.email}
                  onChange={formik.handleChange}
                  name="email"
                  type="email"
                  placeholder="قم بإدخال بريدك الإلكتروني"
                />
              </div>
            </div>
            <div className="input_control w_100">
              <div className="label">
                <p>كلمة السر</p>
              </div>
              <div className="label_input">
                <CloseIcon />
                <input value={formik.values.password} onChange={formik.handleChange} type="password" name="password" placeholder="قم بإدخال كلمة السر" />
              </div>
            </div>
            <div className=" w_100">
              <a href="#" className="forget_pass">
                هل نسيت كلمة السر؟
              </a>
            </div>
            <div className="w_100 ">
              <button className="flex center gap_1">
                {icons.user}
                تسجيل الدخول
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  );
}

export default Login;
